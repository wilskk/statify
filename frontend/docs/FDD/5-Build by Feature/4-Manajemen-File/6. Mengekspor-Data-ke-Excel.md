# Pembangunan Fitur: Mengekspor Data ke Excel

Dokumen ini berisi laporan pembangunan (build report) untuk Feature Set `Mengekspor Data ke Excel`.

---

## 1. Work Package

- **Fitur yang Dibangun:**
  - Mengimplementasikan dialog untuk ekspor ke Excel dengan format `.xlsx` dan `.xls`.
  - Membuat workbook dengan tiga sheet: "Data", "Variables", dan "Metadata".
  - Menerapkan fungsionalitas untuk mengunduh file Excel yang dihasilkan.
- **Tim Fitur (Class Owners):**
  - `[Nama Tim/Developer]`
- **Tanggal Aktual:**
  - **Pembangunan:** `[Tanggal Mulai]` - `[Tanggal Selesai]`
  - **Unit Testing:** `[Tanggal Selesai]`
  - **Inspeksi Kode:** `[Tanggal Selesai]`

---

## 2. Implementation

- **Lokasi Kode Sumber Utama:**
  - `frontend/components/Modals/File/ExportExcel/index.tsx`: Komponen UI untuk modal ekspor Excel.
  - `frontend/hooks/useExportExcelLogic.ts`: Hook yang menangani logika pembuatan dan pengunduhan file Excel.
- **Dependensi Kunci:**
  - `SheetJS` (`xlsx`): Library untuk membuat file Excel di sisi klien.
  - `zustand`: untuk mengakses data dan metadata dari data stores.

---

## 3. Unit Testing

- **Framework & Tools:**
  - **Jest:** Test runner.
  - **React Testing Library:** Untuk rendering dan interaksi dengan komponen UI.
  - **Zustand Test Utils:** Untuk mock stores.
  - **`mock-fs`**: Untuk mem-mock sistem file jika diperlukan saat pengujian.

- **Skenario Pengujian:**
  - **File:** `ExportExcel.test.tsx`, `useExportExcelLogic.test.ts`
  - **Deskripsi:** Pengujian ini memverifikasi bahwa logika untuk mengekspor data ke Excel berfungsi seperti yang diharapkan, termasuk pembuatan workbook dengan sheet yang benar dan pemicuan unduhan.

| Test Case ID | Deskripsi | Aksi | Hasil yang Diharapkan | Status |
| :--- | :--- | :--- | :--- | :--- |
| **EXCEL-UI-1** | Render komponen modal | Render `ExportExcelModal`. | Modal ditampilkan dengan input nama file dan tombol 'Ekspor'. | `Passed` |
| **EXCEL-LOGIC-1**| Panggilan `handleExport` | Panggil `handleExport` dengan konfigurasi. | Fungsi dari `SheetJS` untuk membuat workbook dipanggil. | `Passed` |
| **EXCEL-LOGIC-2**| Pembuatan Workbook | Eksekusi logika `handleExport`. | Workbook dibuat dengan tiga sheet: `Data`, `Variables`, dan `Metadata`. | `Passed` |
| **EXCEL-LOGIC-3**| Konten Sheet 'Data' | Periksa konten sheet `Data` yang dihasilkan. | Sheet `Data` berisi data dari `useDataStore` dengan header yang benar. | `Passed` |
| **EXCEL-LOGIC-4**| Konten Sheet 'Variables'| Periksa konten sheet `Variables`. | Sheet `Variables` berisi metadata variabel dari `useMetaStore`. | `Passed` |
| **EXCEL-LOGIC-5**| Pemicu Unduhan | Panggil `handleExport`. | Fungsi untuk membuat `<a>` tag dan memicu klik untuk unduhan dipanggil. | `Passed` |

---

## 4. Laporan Inspeksi Kode (Code Inspection Report)

- **Hasil:** `[Lulus / Lulus dengan Catatan / Gagal]`
- **Catatan Review:**
  - `[Catatan dari reviewer 1]`
  - `[Catatan dari reviewer 2]`

---

## 5. Status Promosi ke Build

- **Status:** `[Siap / Belum Siap]`
- **Catatan:**
  - `[Catatan mengenai kesiapan fitur untuk diintegrasikan ke dalam build utama]`
