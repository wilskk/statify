# Desain Fitur: Tampilan Hasil

Dokumen ini berisi paket desain (Design Package) untuk Feature Set `Tampilan Hasil`.

---

## 2. Design Package

### 2.1. Diagram Urutan (Sequence Diagrams)

Dokumentasi ini berisi diagram sekuens yang menjelaskan alur kerja utama dan interaksi komponen di Halaman Hasil. Diagram telah disesuaikan untuk kejelasan yang lebih baik.

---

### 1. Alur Pengeditan Deskripsi (Fitur #50)

Diagram ini menunjukkan bagaimana pengguna mengedit deskripsi sebuah hasil statistik menggunakan editor teks, yang kemudian disimpan kembali ke state.

```mermaid
sequenceDiagram
    autonumber
    actor User as "Pengguna"

    box "Antarmuka Pengguna (UI)"
        participant View as "ResultOutput"
        participant Editor as "TiptapEditor"
    end

    box "Manajemen State"
        participant Store as "useResultStore"
    end

    User->>View: 1. Klik tombol "Edit" pada catatan
    activate View

    View->>View: 2. Set state internal ke mode edit
    View->>Editor: 3. Render editor dengan `editable=true`
    activate Editor

    User->>Editor: 4. Mengubah teks deskripsi
    Editor-->>View: 5. Memicu `onChange` untuk update state sementara

    User->>Editor: 6. Klik tombol "Save"
    Editor-->>View: 7. Memicu callback `onSave()`
    deactivate Editor

    View->>Store: 8. Panggil `updateStatistic(id, { description })`
    activate Store
    Note right of Store: State diperbarui & disinkronkan ke backend.

    Store-->>View: 9. Notifikasi perubahan state (memicu re-render)
    deactivate Store

    View->>View: 10. Reset state (keluar dari mode edit)
    deactivate View
end
```

---

### 2. Alur Penghapusan Item dari Sidebar (Fitur #47)

Diagram berikut menjelaskan alur saat pengguna menghapus sebuah item analisis dari sidebar navigasi, termasuk langkah konfirmasi.

```mermaid
sequenceDiagram
    autonumber
    actor User as "Pengguna"

    box "Antarmuka Pengguna (UI)"
        participant MenuItem as "SidebarMenuItem"
        participant Dialog as "AlertDialog"
    end

    box "Manajemen State"
        participant Store as "useResultStore"
    end

    User->>MenuItem: 1. Klik ikon "Trash"
    activate MenuItem

    MenuItem->>Dialog: 2. Tampilkan dialog konfirmasi
    activate Dialog

    User->>Dialog: 3. Klik tombol "Delete" pada dialog
    Dialog-->>MenuItem: 4. Memicu callback `handleDelete()`
    deactivate Dialog
    
    MenuItem->>Store: 5. Panggil `deleteAnalytic(analyticId)`
    activate Store
    Note right of Store: Menghapus item dari state &<br/>mengirim permintaan ke backend.
    
    Store-->>MenuItem: 6. Notifikasi update state (memicu re-render)
    deactivate Store
    
    deactivate MenuItem
    Note right of MenuItem: Sidebar di-render ulang dengan data terbaru.
end
```

### 2.2. Penyempurnaan Model Objek (Object Model Refinements)

*Perubahan pada model objek (kelas, atribut, metode baru) yang ditemukan selama desain.*

- **Komponen Baru:**
  - `output/Sidebar.tsx` (#47): Komponen sidebar yang menampilkan daftar semua hasil analisis dan log sebagai item navigasi.
  - `output/ResultOutput.tsx` (#48): Komponen utama yang merender konten dari hasil analisis yang dipilih (tabel, grafik, catatan).
  - `Output/Table/data-table.tsx` (#49): Komponen tabel generik yang digunakan untuk menampilkan data statistik dalam format terstruktur.
  - `Output/Editor/TiptapEditor.tsx` (#50): Komponen editor teks kaya (WYSIWYG) berbasis Tiptap untuk membuat dan mengedit catatan.
- **Store Baru/Atribut Baru:**
  - `useResultStore.ts`: Store Zustand yang bertanggung jawab untuk mengelola seluruh state halaman hasil.
    - `results: ResultItem[]`: Menyimpan array dari semua objek hasil analisis.
    - `activeResultId: string | null`: Menyimpan ID dari hasil yang sedang aktif ditampilkan.
    - `addResult(result)`: Menambahkan hasil analisis baru ke dalam state.
    - `updateStatistic(id, payload)`: Memperbarui properti dari sebuah hasil (misal: deskripsi).
    - `deleteAnalytic(id)`: Menghapus sebuah hasil analisis dari state.
    - `setActiveResult(id)`: Mengatur hasil mana yang akan ditampilkan di area konten utama.

### 2.3. Catatan Alternatif Desain (Design Alternatives)

*Diskusi dan keputusan mengenai pilihan desain yang signifikan.*

- **Alternatif 1:** Merender setiap output analisis sebagai halaman terpisah dengan URL-nya sendiri (misal: `/dashboard/result/analysis-123`).
  - **Kelebihan:** Setiap hasil dapat di-bookmark dan dibagikan secara langsung melalui URL.
  - **Kekurangan:** Akan menciptakan banyak rute (route) yang dinamis dan lebih kompleks untuk dikelola. Navigasi antar hasil akan terasa lebih lambat karena memerlukan pemuatan halaman penuh.
- **Keputusan:** Menggunakan layout tunggal (halaman `/dashboard/result`) dengan sidebar untuk navigasi. Konten di area utama diubah secara dinamis berdasarkan state (`activeResultId`). Ini menciptakan pengalaman pengguna yang lebih cepat, lebih terintegrasi, dan terasa seperti aplikasi desktop statistik tradisional, yang menjadi tujuan dari proyek ini. 