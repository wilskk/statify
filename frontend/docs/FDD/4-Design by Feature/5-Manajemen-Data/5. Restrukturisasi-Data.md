# Desain Fitur: Restrukturisasi Data

Dokumen ini berisi paket desain (Design Package) untuk Feature Set `Restrukturisasi Data`.

---

## 1. Work Package

- **Fitur yang Dikerjakan:**
  - Membuka wizard Restrukturisasi Data.
  - Memilih tipe restrukturisasi (variabel ke kasus atau kasus ke variabel).
  - Memilih variabel identifikasi, indeks, dan yang akan direstruktur.
  - Menjalankan logika restrukturisasi di service.
- **Tim Fitur (Class Owners):**
  - `[Nama Tim/Developer]`
- **Jadwal (Estimasi):**
  - **Walkthrough:** `[Tanggal]`
  - **Design:** `[Tanggal]`
  - **Design Review:** `[Tanggal]`

---

## 2. Design Package

### 2.1. Diagram Urutan (Sequence Diagrams)

*Diagram ini menunjukkan alur di mana pengguna mengonfigurasi dan menjalankan proses restrukturisasi.*

### **Sequence Diagram: Restructure Data**

Dokumentasi ini berisi diagram sekuens yang merinci alur kerja fitur "Restructure Data", yang diimplementasikan sebagai wizard multi-langkah.

---

### 1. Alur Proses Wizard Restructure Data

Diagram ini mengilustrasikan alur interaksi pengguna melalui berbagai langkah wizard, validasi per langkah, dan proses akhir yang mentransformasi data dan skema variabel.

```mermaid
sequenceDiagram
    title: Alur Proses Wizard Restructure Data
    actor User

    box "Frontend Components"
        participant UI as "RestructureUI<br>.../Restructure/RestructureUI.tsx"
    end
    
    box "Hooks & Services"
        participant Hook as "useRestructure<br>.../hooks/useRestructure.ts"
        participant Service as "restructureService<br>.../services/restructureService.ts"
    end
    
    box "Zustand Stores"
        participant VarStore as "useVariableStore"
        participant DataStore as "useDataStore"
    end

    User->>+UI: Buka wizard "Restructure Data"
    UI->>+Hook: Inisialisasi hook
    Hook->>+VarStore: Get variables
    deactivate VarStore
    Hook-->>-UI: Return state awal (Langkah 1)
    UI-->>User: Tampilkan pilihan metode

    User->>UI: Pilih metode & klik "Next"
    UI->>+Hook: handleNext()
    Hook->>Hook: Validasi Langkah 1
    Hook-->>-UI: Return state untuk Langkah 2
    UI-->>User: Tampilkan pemilihan variabel

    User->>UI: Pilih variabel & klik "Next"
    UI->>+Hook: handleNext()
    Hook->>Hook: Validasi Langkah 2
    Hook-->>-UI: Return state untuk Langkah 3
    UI-->>User: Tampilkan Opsi

    User->>UI: Konfigurasi opsi & klik "Finish"
    UI->>+Hook: handleFinish()
    Hook->>Hook: Validasi Langkah 3
    Hook->>+Service: restructureData(data, vars, config)
    Service->>Service: Melakukan transformasi data
    Service-->>-Hook: Return { newData, newVariables }
    deactivate Service

    Hook->>+DataStore: setData(newData)
    deactivate DataStore

    Hook->>+VarStore: overwriteVariables(newVariables)
    deactivate VarStore

    Hook->>UI: onClose()
    deactivate Hook
    deactivate UI
```

### 2.2. Penyempurnaan Model Objek (Object Model Refinements)

*Perubahan pada model objek (kelas, atribut, metode baru) yang ditemukan selama desain.*

- **Komponen Wizard:**
  - `Restructure/index.tsx`: Komponen induk yang mengelola langkah-langkah wizard.
  - `RestructureUI.tsx`: Komponen utama yang berisi antarmuka untuk memilih variabel-variabel yang relevan (identifikasi, indeks, dll.) berdasarkan tipe restrukturisasi yang dipilih.
- **Service:**
  - `restructureService.ts`: Berisi logika murni untuk dua operasi inti:
    1.  **Variabel ke Kasus (Wide to Long):** Mengambil beberapa kolom dan mengubahnya menjadi dua kolom: satu kolom indeks (menunjukkan nama variabel asli) dan satu kolom nilai.
    2.  **Kasus ke Variabel (Long to Wide):** Melakukan operasi pivot, mengambil kolom indeks untuk membuat kolom-kolom baru.
- **Pola Desain:**
  - **Wizard Pattern:** Membimbing pengguna melalui proses multi-langkah yang kompleks.

### 2.3. Catatan Alternatif Desain (Design Alternatives)

*Diskusi dan keputusan mengenai pilihan desain yang signifikan.*

- **Alternatif 1:** Menjalankan restrukturisasi di web worker.
  - **Kelebihan:** Mencegah UI freeze untuk data yang sangat besar.
  - **Kekurangan:** Menambah kompleksitas.
- **Keputusan:** Awalnya mengimplementasikan di thread utama. Logika restrukturisasi (terutama `reduce` dan `map`) seringkali cukup cepat untuk dataset berukuran sedang. Jika pengujian performa dengan data besar menunjukkan adanya kelambatan yang signifikan, logika ini dapat dengan mudah dipindahkan ke web worker di masa depan tanpa mengubah UI atau service signature.

---

## 3. Laporan Inspeksi Desain (Design Inspection Report)

- **Hasil:** `[Diterima / Diterima dengan Revisi / Ditolak]`
- **Cacat yang Ditemukan:**
  1. `[Deskripsi Cacat 1]`
- **Daftar Tugas (To-Do List):**
  - `[Tindakan perbaikan 1]` 