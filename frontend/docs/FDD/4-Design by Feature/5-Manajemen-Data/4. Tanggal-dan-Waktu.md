# Desain Fitur: Tanggal & Waktu

Dokumen ini berisi paket desain (Design Package) untuk Feature Set `Tanggal & Waktu`.

---

## 2. Design Package

### 2.1. Diagram Urutan (Sequence Diagrams)

*Diagram ini menunjukkan alur di mana pengguna menggunakan wizard untuk membuat variabel tanggal baru dari sebuah string.*

### **Sequence Diagram: Define Date and Time**

Dokumentasi ini berisi diagram sekuens yang merinci alur kerja fitur "Define Date and Time", yang digunakan untuk membuat variabel tanggal dan waktu secara otomatis.

---

### 1. Alur Proses Pembuatan Variabel Tanggal

Diagram ini menunjukkan bagaimana interaksi pengguna dalam dialog memicu pembuatan metadata, definisi variabel baru, dan pengisian data sel terkait.

```mermaid
sequenceDiagram
    title: Alur Proses Pembuatan Variabel Tanggal & Waktu
    actor User

    box "Frontend"
        participant Modal as "DefineDateTime<br>.../DefineDateTime/index.tsx"
        participant Hook as "useDefineDateTime<br>.../hooks/useDefineDateTime.ts"
        participant Service as "dateTimeService<br>.../services/dateTimeService.ts"
        participant Utils as "dateTimeFormatters<br>.../utils/dateTimeFormatters.ts"
    end

    box "Zustand Stores"
        participant MetaStore as "useMetaStore"
        participant VarStore as "useVariableStore"
        participant DataStore as "useDataStore"
    end

    User->>+Modal: Buka modal "Define Dates"
    Modal->>+Hook: Inisialisasi hook
    Hook-->>-Modal: Mengembalikan state awal
    Modal-->>User: Menampilkan dialog

    User->>Modal: Pilih format tanggal & atur nilai awal
    User->>Modal: Klik tombol "OK"

    Modal->>+Hook: handleOk()
    
    alt Jika "Not dated" dipilih
        Hook->>+VarStore: resetVariables()
        deactivate VarStore
        Hook->>+MetaStore: setMeta({ dates: "" })
        deactivate MetaStore
    else
        Hook->>+Utils: formatDateForMetaStore()
        Utils-->>-Hook: dateString
        
        Hook->>+MetaStore: setMeta({ dates: dateString })
        deactivate MetaStore

        Hook->>+Service: prepareDateVariables(timeComponents, ...)
        Service->>Service: Membuat definisi variabel baru
        Service->>+Utils: generateSampleData()
        Utils-->>-Service: cellUpdates
        Service-->>-Hook: Mengembalikan { variablesToCreate, cellUpdates }
        deactivate Service

        loop untuk setiap variabel baru
            Hook->>+VarStore: addVariable(variable)
            deactivate VarStore
        end

        Hook->>+DataStore: updateCells(cellUpdates)
        deactivate DataStore
    end

    Hook->>Modal: onClose()
    deactivate Hook
    deactivate Modal
```

### 2.2. Penyempurnaan Model Objek (Object Model Refinements)

*Perubahan pada model objek (kelas, atribut, metode baru) yang ditemukan selama desain.*

- **Komponen Wizard:**
  - `DefineDateTime/index.tsx`: Komponen utama yang berfungsi sebagai wizard, menampilkan langkah-langkah yang berbeda tergantung pada fungsi yang dipilih.
- **Service:**
  - `dateTimeService.ts`: Berisi semua logika bisnis murni untuk manipulasi tanggal dan waktu. Misalnya, fungsi untuk mem-parsing string ke tanggal berdasarkan format tertentu, atau menghitung durasi antara dua tanggal. Service ini tidak bergantung pada state aplikasi.
- **Utilitas:**
  - `dateTimeFormatters.ts`: Berisi daftar format tanggal/waktu yang didukung dan fungsi untuk memformat tanggal ke dalam representasi string yang berbeda.

### 2.3. Catatan Alternatif Desain (Design Alternatives)

*Diskusi dan keputusan mengenai pilihan desain yang signifikan.*

- **Alternatif 1:** Menggunakan fungsi `Date.parse()` bawaan JavaScript.
  - **Kelebihan:** Tidak ada dependensi eksternal.
  - **Kekurangan:** Sangat tidak dapat diandalkan. Perilakunya bervariasi antar browser dan hanya mendukung beberapa format terbatas (sub-set dari ISO 8601). Sama sekali tidak cocok untuk menangani berbagai format tanggal yang ditemukan dalam kumpulan data dunia nyata (misalnya, `dd/mm/yyyy`, `mm-dd-yy`).
- **Keputusan:** Menggunakan library manipulasi tanggal yang kuat dan teruji seperti `date-fns` atau `moment.js`. Ini memastikan parsing dan pemformatan yang konsisten dan dapat diandalkan di semua lingkungan, dan menyediakan dukungan untuk berbagai format input dan output yang diperlukan untuk alat analisis data.

--- 