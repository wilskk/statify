# Desain Fitur: Manipulasi Data (Kasus)

Dokumen ini berisi paket desain (Design Package) untuk Feature Set `Manipulasi Data (Kasus)`.

---

## 2. Design Package

### 2.1. Diagram Urutan (Sequence Diagrams)

*Diagram ini menunjukkan alur pengurutan kasus, yang dieksekusi di web worker untuk menjaga responsivitas UI.*

### **Sequence Diagram: Sort Cases**

Dokumentasi ini berisi diagram sekuens yang merinci alur kerja fitur "Sort Cases", yang memungkinkan pengguna untuk mengurutkan baris data berdasarkan satu atau lebih variabel.

---

### 1. Alur Proses Pengurutan Kasus

Diagram ini mengilustrasikan bagaimana pengguna memilih variabel untuk pengurutan, mengubah arah pengurutan, dan bagaimana perubahan tersebut diterapkan pada `DataStore` setelah konfirmasi.

```mermaid
sequenceDiagram
    title: Alur Proses Pengurutan Kasus (Baris)
    actor User

    box "Frontend Components"
        participant UI as "SortCasesUI<br>.../SortCases/SortCasesUI.tsx"
    end
    
    box "Hooks & Stores"
        participant Hook as "useSortCases<br>.../hooks/useSortCases.ts"
        participant DataStore as "useDataStore"
    end

    User->>+UI: Buka modal "Sort Cases"
    UI->>+Hook: Inisialisasi hook
    Hook-->>-UI: Return state awal
    UI-->>User: Tampilkan modal dengan variabel yang tersedia

    User->>UI: Pindahkan variabel ke daftar 'Sort By'
    UI->>+Hook: handleMoveVariable(...)
    Hook->>Hook: Memperbarui `sortByConfigs` dengan arah default
    Hook-->>-UI: Return state yang diperbarui

    User->>UI: Pilih variabel dan ubah arah pengurutan
    UI->>+Hook: changeSortDirection(tempId, 'desc')
    Hook->>Hook: Memperbarui arah untuk konfigurasi tertentu
    Hook-->>-UI: Return state yang diperbarui
    deactivate Hook

    User->>UI: Klik tombol "OK"
    UI->>+Hook: handleOk()
    Hook->>Hook: performSort()

    loop untuk setiap konfigurasi di sortByConfigs
        Hook->>+DataStore: sortData(columnIndex, direction)
        deactivate DataStore
    end

    deactivate Hook
    Hook->>UI: onClose()
    deactivate Hook
    deactivate UI
```

### 2.2. Penyempurnaan Model Objek (Object Model Refinements)

*Perubahan pada model objek (kelas, atribut, metode baru) yang ditemukan selama desain.*

- **Komponen Modal:**
  - `SortCasesUI.tsx`: Komponen yang menyediakan antarmuka bagi pengguna untuk memilih variabel, menambahkannya ke daftar urutan, dan mengatur arah (naik/turun).
- **Service/Store:**
  - `DataService.ts` (atau langsung di `useDataStore.ts`): Memiliki metode `sortCases` yang mengambil konfigurasi urutan, mengirim data saat ini dan konfigurasi ke web worker, dan menerima kembali data yang sudah diurutkan untuk memperbarui state.
- **Web Worker:**
  - Sebuah worker JavaScript khusus untuk melakukan operasi pengurutan yang intensif secara komputasi tanpa memblokir thread utama.

### 2.3. Catatan Alternatif Desain (Design Alternatives)

*Diskusi dan keputusan mengenai pilihan desain yang signifikan.*

- **Alternatif 1:** Melakukan pengurutan langsung di thread utama JavaScript.
  - **Kelebihan:** Implementasi lebih sederhana, tidak perlu mengelola worker.
  - **Kekurangan:** Untuk dataset yang besar (misalnya, >50,000 baris), operasi pengurutan dapat memakan waktu beberapa detik dan akan membekukan seluruh antarmuka pengguna (UI), memberikan pengalaman yang buruk.
- **Keputusan:** Menggunakan Web Worker. Meskipun menambah sedikit kompleksitas dalam komunikasi (via `postMessage`), ini adalah solusi yang tepat untuk tugas-tugas berat. Ini memastikan UI tetap responsif dan pengguna dapat melihat indikator pemuatan saat pengurutan berlangsung di latar belakang. 