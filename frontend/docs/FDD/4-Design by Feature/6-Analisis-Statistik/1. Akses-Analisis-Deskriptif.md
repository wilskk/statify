# Desain Fitur: Akses Analisis Deskriptif

Dokumen ini berisi paket desain (Design Package) untuk Feature Set `Akses Analisis Deskriptif`.

---

## 2. Design Package

### 2.1. Diagram Urutan (Sequence Diagrams)

*Diagram ini menggambarkan bagaimana sistem modal generik digunakan untuk meluncurkan modal analisis spesifik dari sub-menu Analyze > Descriptive Statistics.*

### **Sequence Diagrams: Interaksi Analisis Deskriptif**

Dokumentasi ini berisi generalisasi diagram sekuens (sequence diagrams) yang menjelaskan alur kerja dan pola interaksi yang umum ditemukan pada semua fitur analisis deskriptif (seperti Frequencies, Descriptives, Crosstabs, dan Explore).

---

### 1. Alur Umum Konfigurasi Analisis

Diagram ini menggeneralisasi proses di mana pengguna mengonfigurasi sebuah analisis sebelum menjalankannya. Ini mencakup pemilihan variabel dan pengaturan opsi spesifik (seperti statistik, sel, atau grafik) melalui antarmuka berbasis tab.

```mermaid
sequenceDiagram
    title: Alur Umum Konfigurasi Analisis Deskriptif
    actor User

    box "Frontend"
        participant View as UI (Modal/View)
        participant Tabs as "Tabs (Variables, Stats, Charts, etc.)"
        participant Hooks as Configuration Hooks
    end

    User->>+View: Membuka dialog analisis
    User->>+Tabs: Berinteraksi dengan elemen UI di dalam tab
    Note left of Tabs: - Memindahkan variabel (drag-n-drop)<br/>- Mencetang checkbox (opsi statistik)<br/>- Memilih radio button (tipe grafik)
    Tabs->>+Hooks: Memanggil fungsi untuk memperbarui state
    Hooks->>Hooks: Mengubah state internal (misal: `setSelectedVariables`, `setOptions`)
    deactivate Hooks
    deactivate Tabs
    deactivate View
    Note right of Hooks: Perubahan state ini akan<br/>digunakan saat analisis dieksekusi.
```

---

### 2. Alur Umum Eksekusi Analisis (via Web Worker)

Diagram berikut merangkum alur kerja utama saat analisis dieksekusi. Pola yang paling penting adalah pendelegasian komputasi statistik yang berat ke **Web Worker** untuk menjaga antarmuka tetap responsif.

```mermaid
sequenceDiagram
    title: Alur Umum Eksekusi Analisis Deskriptif
    actor User

    box "Frontend"
        participant View as UI (Modal/View)
        participant AnalysisHook as "Main Analysis Hook"
        participant Worker as "Web Worker"
        participant ResultStore as "Result Store (Zustand)"
    end

    User->>+View: Klik tombol "OK"
    View->>+AnalysisHook: Memanggil `runAnalysis()`
    AnalysisHook->>AnalysisHook: Mengatur `isCalculating = true`
    AnalysisHook->>ResultStore: `addLog()` & `addAnalytic()` (Menyiapkan entri hasil)
    ResultStore-->>AnalysisHook: Mengembalikan `analyticId`

    AnalysisHook->>+Worker: Create
    AnalysisHook->>Worker: `postMessage({ data, options, ... })`
    Note right of Worker: Komputasi berat terjadi di sini.<br/>Beberapa analisis (Crosstabs, Explore)<br/>dapat mengirim beberapa pesan ke worker<br/>untuk setiap pasangan variabel/kelompok.

    Worker->>Worker: Menghitung statistik...
    Worker-->>AnalysisHook: `onmessage = { results, ... }`

    rect rgb(220, 220, 220)
    note over AnalysisHook, ResultStore: Pemrosesan Hasil
    AnalysisHook->>AnalysisHook: Mengumpulkan dan memformat hasil dari worker
    AnalysisHook->>ResultStore: `addStatistic(analyticId, { formatted_output })`
    Note right of ResultStore: Hasil yang sudah diformat (tabel,<br/>data grafik) disimpan ke store.
    end

    alt Semua hasil sudah diproses
        AnalysisHook->>AnalysisHook: `isCalculating = false`
        AnalysisHook->>Worker: `terminate()`
        AnalysisHook->>View: `onClose()`
    end
    deactivate AnalysisHook
    deactivate View
```

### 2.2. Penyempurnaan Model Objek (Object Model Refinements)

*Perubahan pada model objek (kelas, atribut, metode baru) yang ditemukan selama desain.*

- **Komponen Menu:**
  - `DescriptiveMenu.tsx`: Komponen yang membangun struktur menu "Analyze > Descriptive Statistics" (misalnya, Frequencies, Descriptives, Crosstabs). Setiap item menu memanggil `useModalStore.openModal` dengan ID unik dari modal analisis yang diinginkan.
- **Registry Spesifik:**
  - `DescriptiveRegistry.tsx`: Sebuah objek pemetaan dari ID modal deskriptif ke komponen modal yang sebenarnya, menggunakan `React.lazy` untuk pemuatan kode on-demand. Registry ini akan digabungkan ke dalam `AnalyzeRegistry` yang lebih besar dan kemudian ke `ModalRegistry` utama.
- **Pola Desain:**
  - **Registry Pattern & Lazy Loading:** Sama seperti `FileRegistry`, ini memungkinkan pemanggilan komponen secara dinamis dan efisien, memastikan kode untuk analisis yang kompleks hanya dimuat saat diperlukan.

### 2.3. Catatan Alternatif Desain (Design Alternatives)

*Diskusi dan keputusan mengenai pilihan desain yang signifikan.*

- **Keputusan:** Menggunakan pola arsitektur yang sama dengan `FileMenu` dan `FileRegistry` untuk konsistensi di seluruh aplikasi. Pola `Manager` dan `Registry` terpusat terbukti efektif untuk mengelola puluhan modal yang berbeda secara bersih dan efisien.

--- 