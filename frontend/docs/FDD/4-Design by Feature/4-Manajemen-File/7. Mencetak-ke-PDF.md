# Desain Fitur: Mencetak ke PDF

Dokumen ini berisi paket desain (Design Package) untuk Feature Set `Mencetak ke PDF`.

---

## 2. Design Package

### 2.1. Diagram Urutan (Sequence Diagrams)

*Diagram ini menunjukkan alur pembuatan PDF sepenuhnya di sisi klien, mulai dari interaksi pengguna hingga pemanggilan pustaka `jsPDF`.*

```mermaid
sequenceDiagram
    title: Alur Proses Mencetak ke PDF
    actor User as "Pengguna"

    box "Frontend"
        participant Modal as "PrintModal"
        participant Hook as "usePrintLogic<br>.../hooks/usePrintLogic.ts"
        participant Service as "pdfPrintService<br>.../services/pdfPrintService.ts"
    end

    box "External Libraries"
        participant jsPDF as "jsPDF / jspdf-autotable"
    end
    
    autonumber

    User->>+Modal: Buka modal, memilih opsi cetak & klik 'Cetak'
    Modal->>+Hook: Panggil `handlePrint(options)`
    deactivate Modal
    
    Hook->>+Service: Panggil `generatePdf(options)`
    Note over Service: Service mengambil data yang relevan<br/>(misal: dari Zustand store atau dari DOM)
    
    Service->>+jsPDF: Buat dokumen PDF baru (`new jsPDF()`)
    Service->>+jsPDF: Tambahkan konten ke dokumen (misal: `autoTable()` atau `html()`)
    Service->>+jsPDF: Panggil `save(filename)`
    
    jsPDF-->>User: Munculkan dialog unduh file
    deactivate jsPDF
    
    Service-->>-Hook: Proses selesai
    deactivate Service
    
    Hook->>Hook: Panggil `onClose()` untuk menutup modal
    deactivate Hook
end
```

### 2.2. Penyempurnaan Model Objek (Object Model Refinements)

*Perubahan pada model objek (kelas, atribut, metode baru) yang ditemukan selama desain.*

- **Komponen:**
  - `PrintOptions.tsx`: Komponen UI yang berisi semua opsi cetak (konten, ukuran kertas, dll).
- **Hook Logika:**
  - `usePrintLogic.ts`: Mengelola state opsi, memanggil service untuk menghasilkan PDF saat pengguna mengklik tombol cetak.
- **Service Klien:**
  - `pdfPrintService.ts`: Logika inti untuk pembuatan PDF. Service ini bertanggung jawab untuk:
    1. Mengambil data/HTML yang benar berdasarkan pilihan konten (misalnya, mengambil data dari `useDataStore` atau HTML dari komponen Hasil Analisis).
    2. Menggunakan `jsPDF` dan `jspdf-autotable` untuk mengubah data atau HTML tersebut menjadi dokumen PDF.
    3. Memicu pengunduhan file PDF yang dihasilkan.
- **Dependensi:**
  - `jsPDF`: Library utama untuk membuat dokumen PDF di klien.
  - `jspdf-autotable`: Plugin untuk `jsPDF` yang mempermudah pembuatan tabel dari data JSON/array.

### 2.3. Catatan Alternatif Desain (Design Alternatives)

*Diskusi dan keputusan mengenai pilihan desain yang signifikan.*

- **Alternatif 1:** Mengandalkan fungsi cetak bawaan browser (`window.print()`) dengan stylesheet khusus cetak (`@media print`).
  - **Kelebihan:** Sangat sederhana, tidak perlu dependensi.
  - **Kekurangan:** Kontrol yang sangat terbatas atas output akhir (header, footer, penomoran halaman). Hasil dapat sangat bervariasi antar browser. Tidak menghasilkan file PDF secara langsung, hanya membuka dialog cetak.
- **Keputusan:** Menggunakan `jsPDF`. Ini memberikan kontrol penuh atas pembuatan dokumen PDF, memastikan output yang konsisten di semua browser, dan memungkinkan pembuatan file PDF secara langsung untuk diunduh oleh pengguna, yang merupakan pengalaman yang lebih baik. 